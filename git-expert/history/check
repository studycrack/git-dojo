#!/opt/pwn.college/bash

set -e

repo=$PWD                       # Must be run inside the repository directory
expected=$(cat /challenge/expected_commit)
current=$(git rev-parse HEAD)

if [[ "$current" == "$expected" ]]; then
  if grep -q "The flag is safe" answer.txt; then
    echo "[+] Congratulations! You have successfully reverted to the correct version."
    echo -n "Your flag is: "
    cat /flag
    exit 0
  fi
fi

echo "[-] You are not yet at the correct commit!"
echo "(Hint: use git log to find the commit, then git checkout <hash>)"
exit 1
